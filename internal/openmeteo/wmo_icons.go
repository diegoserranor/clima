package openmeteo

import (
	"math"
	"strings"
)

var wmoIcons = map[int]string{
	0:  icon("   \\|/   ", "  --O--  ", "   /|\\   ", "  --|--  ", "   \\|/   ", "    |    ", "         "),
	1:  icon("   \\|/   ", "  --O--  ", "   /|\\   ", "  .--.   ", " (____)  ", "         ", "         "),
	2:  icon("   \\|/   ", "  --O--  ", "   /|\\   ", "  .--.   ", " (____)  ", "  (____) ", "         "),
	3:  icon("  .--.   ", " (____)  ", "  .--.   ", " (____)  ", "  .--.   ", " (____)  ", "         "),
	45: icon("         ", "  .--.   ", " (____)  ", "~~~~~~~~~", " ~~~~~~~ ", "~~~~~~~~~", "         "),
	48: icon("         ", "  .--.   ", " (____)  ", "~*~*~*~*~", " *~*~*~* ", "~*~*~*~*~", "         "),
	51: icon("  .--.   ", " (____)  ", "   . .   ", "  .  .   ", "   . .   ", "         ", "         "),
	53: icon("  .--.   ", " (____)  ", "  . . .  ", " .  .  . ", "  . . .  ", "         ", "         "),
	55: icon("  .--.   ", " (____)  ", " . . . . ", " . . . . ", " . . . . ", "         ", "         "),
	56: icon("  .--.   ", " (____)  ", "  + . +  ", "   .  +  ", "  +  .   ", "         ", "         "),
	57: icon("  .--.   ", " (____)  ", " + +.+ + ", " + .+. + ", " + +.+ + ", "         ", "         "),
	61: icon("  .--.   ", " (____)  ", "   | |   ", "   | |   ", "   |     ", "         ", "         "),
	63: icon("  .--.   ", " (____)  ", "  | | |  ", "  || ||  ", "  | | |  ", "         ", "         "),
	65: icon("  .--.   ", " (____)  ", " ||||||| ", " ||||||| ", " ||||||| ", "         ", "         "),
	66: icon("  .--.   ", " (____)  ", "  | + |  ", "   |  +  ", "  + |    ", "         ", "         "),
	67: icon("  .--.   ", " (____)  ", " |+|+|+| ", " +||+||+ ", " |+|+|+| ", "         ", "         "),
	71: icon("  .--.   ", " (____)  ", "   *  *  ", "    *    ", "   *     ", "         ", "         "),
	73: icon("  .--.   ", " (____)  ", "  * * *  ", "   ***   ", "  * * *  ", "         ", "         "),
	75: icon("  .--.   ", " (____)  ", " ********", " *** ** *", " ********", "         ", "         "),
	77: icon("  .--.   ", " (____)  ", "  : : :  ", " : : : : ", "  : : :  ", "         ", "         "),
	80: icon("  .--.   ", " (____)  ", "   /  /  ", "  /  /   ", "   /     ", "         ", "         "),
	81: icon("  .--.   ", " (____)  ", "  / / /  ", " / / /   ", "  / / /  ", "         ", "         "),
	82: icon("  .--.   ", " (____)  ", " /////// ", " /////// ", " /////// ", "         ", "         "),
	85: icon("  .--.   ", " (____)  ", "   *  *  ", "  /  *   ", "   *  /  ", "         ", "         "),
	86: icon("  .--.   ", " (____)  ", " **/*/** ", " /*/**/* ", " **/*/** ", "         ", "         "),
	95: icon("  .--.   ", " (____)  ", "   /\\    ", "  /\\/    ", "   \\/    ", "         ", "         "),
	96: icon("  .--.   ", " (____)  ", "   /\\/   ", "  /\\/ o  ", "   \\/  o ", "         ", "         "),
	99: icon("  .--.   ", " (____)  ", "  /\\/\\/  ", " /\\/\\/ o ", "  \\/ o o ", "   o o   ", "         "),
}

var unknownIcon = icon("   ???   ", "  ?   ?  ", "     ?   ", "    ?    ", "    ?    ", "    .    ", "         ")

func MapWeatherIcon(code float64) string {
	key := int(math.Round(code))
	if icon, ok := wmoIcons[key]; ok {
		return icon
	}
	return unknownIcon
}

func icon(lines ...string) string {
	return strings.Join(lines, "\n")
}
